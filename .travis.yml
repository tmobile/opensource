language: go
go:
- 1.8.x
branches:
  only:
  - develop
install:
- go get -v github.com/spf13/hugo
- sudo pip install awscli
script:
- hugo --cleanDestinationDir
deploy:
  provider: s3
  access_key_id: ${AWS_ACCESS_KEY}
  secret_access_key: ${AWS_SECRET_KEY}
  bucket: tmo-opensource-website
  local_dir: public
  skip_cleanup: true
  region: us-west-2
  on:
    branch: develop
after_deploy:
- aws configure set preview.cloudfront true
- ./cdn-invalidate.sh
notifications:
  email:
    on_failure: always
env:
  - secure: h1IxUQgX1wdbTtoRh8BOVwRlqYFNTCZciQxNcTE63tYsl5iZhcX8Oy0z8q+Q9RePU5DqdPLqrdSwijKTqHJENG6KdwM9s814Uc3MJloDjUdT295GDGx7TifFwzQdABEvqVVvo4osiEXZmVoG6Z3fOIb9RJID0IpgOhbFaQf/wF/1dRKGkXiSoK1NHgcLXNOvZhmk/seGYKZiStr8Bk8m8TfGY3A0b0xVxxUIj9wKVRLxdU8l/yrA0MKPZt/8LgkjVJ+jKtH7ldeSwFqD91BIbaiyaurImQcv9mfh9/7mJ8+mEHvN5AHGE9838BN3chWXdjZhv27bMexPV6fhhTYBQwmeLW+k32jkmpxRyQ6nz66/sBbbcvvKsLVpafucEmG8Xl02d9dhczICk10XHfUUIPrp5L9JCtShphp6Kt8792sykX3t7BIB5WuA1j/Ok/35/e8asvt4LD8P0F0IW0ox5U5wSgIPl/MGpsQ9fohA54MrFGEdZ4YD8XiZcJ5yVc4ygbTg/KqaeI60+aV1J7euFH58H+vORnJWAUTyg9HdqufDQJPqxuijVwmROfjoFuRdvp0aV0FqZAwJOf1y5q7hiOoGhrCmtz0d4b6IE0bQOCM+PphBL3zDjZxJH8WBbJVhYsowFKc+5J/JqY9AL30sGXRpX56IJRHXqeO6mBLV9Ao=
  - secure: cwdqS+WBXnp/XzP4/yPKN7frisTQnnCcXqtO/iWmdDnvcnhud6LrWHjRT1YUuoMaaa6vqcHfyVPKFNamON56tM0kCMK4IkrjoOOJtb5569QyNrUIKPO13CCwyMDK4u7C2YVCVO+7sy9seRGbiA6hH2xeqNaNguR+qL71v5OwxA23JxgjpYF2LO+gQvKZoh6E1hcKOh5Kk2OtBqM1OXbSKm4AVQxOF1tCGCcWdHNLhjEkNfR+xqnqWW4xiGwT8DcAmC227PFw7CFeiDchPOtEGXC1MShQQ4vP0rLCb009fBdQzWW4NIeDwldEU/69xb5TNYQntFv2Gn1Qn3dwgG9bcdgtxRJVSg/DLqwHgmDCDy7RiP4plfVxyOzwXKgTVDIXkMqwfRNRj60H8W5+gIXo6Z9FLK0IaEYQaETTWsWwa6DNmcrdYBfv663EKm83hJ5VpJK0qYXskGW/fcjQiUQd9V3Vz19SE5HO2AtV5MmDuI68Lqmm+82dPBZ99sJqXzo4S5O31f288A1cMx2GtxPmWgJ8Ic3hJq3+qOdUIxhPbRlt0qc8mSeQY2ceydDB2TOoAtGoy1zaot343hLZCu6NAo3uRKsDw8/GXYcgmUAU2tlhKwSLCKrjZ9JwdSZ5LQJnjfzgsKPvq/AC1zJHu8QmyPKQ5iUDAVnDX7UWgg2WzD4=
  - secure: R5fkSJ1oFxH1ZdPpjt2x2OeCDZzk0KdJIygQ41muAAI6u60x3OpMxYpWuOKptHv/0Holrp1X8Xn9U9K2r+vdk/dmc9CuMx/I2Ki4typNyoPl/rM5fSMhM6l6GdPrLwmwK6JS+T7oBCE4dKCBuqS8LZxmHxGPm78WwCy5vEARE8kKveo1E5L9kvP1o2m3WwDYl+KXLF6tn+aVEUiUYynQLxsUDZTmv/FoXcWSqapWP5K02dRj3GLj1EhRnwgDsROlUeVpXeZib+ACtSKMlezqnukgO5v5q/hbcVKMD1Zgnj1SX+a15zHxCSFXfewPgJP/HPCSdefohOULhMANNrh3baOx6NEdYSPkW4KSEAEDGh+xEYb9J/8sqbCoFfFAbzw/B1+6rvPTAd/7fmFLXmZW0NX+P/KCDH9JaZPJ+dQszgt15YcW8HxlT2FX0kajlygXozgRIZpDOte2Prmk9K3VPdgdnwllJVtbJL2sVvgSvFwjHl2i+1c2F8SXd2fjwqAmSwednq4Y3xbC33jX5RWv9NDtiLy772whkF0GtXmjvT+GjCmavLAFL//TCuS6vrdqpy/VCvWGTy8lxKAkc/2n9FupeJJ+gCzyVwza3KoCn9n03lay/MfcWz67cTGIJTLCl0eN/W+PKghbJ2JjwKEnpOr7YewhzV01PPgRXAjoNJ8=
  - secure: gIJsgay4p1FLT3k3yQL+M8m4nAgUk6aLEjo/0mB8Fez5pTupm93a3rJMNPVGX+HqmKjbdWIfmWet9ftlzFeVAT2CtY2YQ4JA6mMVCGzpiglLr/t8w7n9HYFjcko+uKPaS783WX1rO7QCC4dTSJTQlWe0zX8O0pMjHeW6TuChb+TQOyBXeoVBbc+WL00h8GCStm9862mcIVF+y/Fw3J8YLkSPveC89mvgQpoBaFtc3MMNbJwNskiWmZge33ZkErk4vVLhXa4Zf2QBOjk76wB74OAxYZkpWMVXD1c1uv4KzDGrEXmKWy9QmDJnEt3JUOKgMvIPdsimasyrU70UbesHEu3mdU3v+qKUWUO2D8JOjMdfgc/cwT8bmkkMI8Gco+aR8odOgU3omrjYSh0vWKlWz59zF3s1f+xzq8V6o401Yit4ld/nAihvEZUuaThq/D1HPzSyytj8Pag44N+NoYIO/SvG8bon9Q9NvnLH08OOfzooHDlKLDyhL72FWiPBgIFrK6EiF8l4tjA2siS9yPKBuTCjBrJ0x2bZZaKF4Tx9cCwh+83/NuqaVQ0doalEyMMGxQtNPo9fTIWY2CdwI1xvgcTBef2KmTKE3RVxBwaHnaMDGtbwaiB9G26h/Br066gW5KSmnBk9m2M0mJsAKxBexIZ/HKte2c04EiYN0r7ZWN0=
  - secure: DQhb66qxjRW0UvFocBignZY5nbf9jUwdEY8Y6yKkmxj+AbnlN6jMA+HhLgxGSJ7q2egaVeJ8lq4dYdRT9yeEZpfg98UBhlVDecBcuqoZ4WzBIMxyDE+ykINr1moZ6TA/zwvvLLNdyAiOhvJ6aYp0avYOTAjl5Eqj6ysjIDJHwfvjY04ZMNeWEb/OJ81ipYhsgBrxUSR3cojnoH6lhVtF+V7Ky6RVVqakKj8A81UQScJiEab0gUBpQDYgD2wjtr8WlQaZBGuNwxbxOrHOm3URCjd4dioi4atvn1Lfz5RfPtcBe6Ga68MkfKl4wO/oTnzqEGR8T01wsYURpcT2FGKsimilADzOGZjKSi8pUAOfWIy1ttYAqxv4hO9wHloPnzF8DZ7Pt9ElwBvxcQTAiziqGP28cAtkhjUDcILSsuuCmvcpSsdOpiymdkr1TlQgrbc/UJT/GSrZvIPA96QSCFxvgJ+RhHLN3xpEA9P46648JN/1k2niz38FtvudE1t4u0um5UUfR+E0rH2lL2aiuSfy458UTr84ylfPa0p/WtezyvnW6F4xZbOWGPT4IyovSCpe8yUoWLq76OLq1z1pzPDaa9OXxdxbfpPO6/5+ZiCxAvpdTPPZVlHuda8m4s5PVGgVUWk/uAhm3EJrzWEkhyrgQvpz1vwMI9LXNjF/ey9QxFY=